Rewrite of the old C code in C++
